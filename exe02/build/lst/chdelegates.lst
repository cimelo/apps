   1               		.file	"chdelegates.c"
   2               	__SP_H__ = 0x3e
   3               	__SP_L__ = 0x3d
   4               	__SREG__ = 0x3f
   5               	__tmp_reg__ = 0
   6               	__zero_reg__ = 1
   7               		.text
   8               	.Ltext0:
   9               		.cfi_sections	.debug_frame
  10               		.section	.text.__ch_delegate_fn0,"ax",@progbits
  11               	.global	__ch_delegate_fn0
  13               	__ch_delegate_fn0:
  14               	.LFB98:
  15               		.file 1 "../../../os/oslib/src/chdelegates.c"
   1:../../../os/oslib/src/chdelegates.c **** /*
   2:../../../os/oslib/src/chdelegates.c ****     ChibiOS - Copyright (C) 2006,2007,2008,2009,2010,2011,2012,2013,2014,
   3:../../../os/oslib/src/chdelegates.c ****               2015,2016,2017,2018,2019,2020,2021 Giovanni Di Sirio.
   4:../../../os/oslib/src/chdelegates.c **** 
   5:../../../os/oslib/src/chdelegates.c ****     This file is part of ChibiOS.
   6:../../../os/oslib/src/chdelegates.c **** 
   7:../../../os/oslib/src/chdelegates.c ****     ChibiOS is free software; you can redistribute it and/or modify
   8:../../../os/oslib/src/chdelegates.c ****     it under the terms of the GNU General Public License as published by
   9:../../../os/oslib/src/chdelegates.c ****     the Free Software Foundation version 3 of the License.
  10:../../../os/oslib/src/chdelegates.c **** 
  11:../../../os/oslib/src/chdelegates.c ****     ChibiOS is distributed in the hope that it will be useful,
  12:../../../os/oslib/src/chdelegates.c ****     but WITHOUT ANY WARRANTY; without even the implied warranty of
  13:../../../os/oslib/src/chdelegates.c ****     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  14:../../../os/oslib/src/chdelegates.c ****     GNU General Public License for more details.
  15:../../../os/oslib/src/chdelegates.c **** 
  16:../../../os/oslib/src/chdelegates.c ****     You should have received a copy of the GNU General Public License
  17:../../../os/oslib/src/chdelegates.c ****     along with this program.  If not, see <http://www.gnu.org/licenses/>.
  18:../../../os/oslib/src/chdelegates.c **** */
  19:../../../os/oslib/src/chdelegates.c **** 
  20:../../../os/oslib/src/chdelegates.c **** /**
  21:../../../os/oslib/src/chdelegates.c ****  * @file    oslib/src/chdelegates.c
  22:../../../os/oslib/src/chdelegates.c ****  * @brief   Delegate threads code.
  23:../../../os/oslib/src/chdelegates.c ****  * @details Delegate threads.
  24:../../../os/oslib/src/chdelegates.c ****  *          <h2>Operation mode</h2>
  25:../../../os/oslib/src/chdelegates.c ****  *          A delegate thread is a thread performing function calls triggered
  26:../../../os/oslib/src/chdelegates.c ****  *          by other threads. This functionality is especially useful when
  27:../../../os/oslib/src/chdelegates.c ****  *          encapsulating a library not designed for threading into a
  28:../../../os/oslib/src/chdelegates.c ****  *          delegate thread. Other threads have access to the library without
  29:../../../os/oslib/src/chdelegates.c ****  *          having to worry about mutual exclusion.
  30:../../../os/oslib/src/chdelegates.c ****  * @pre     In order to use the pipes APIs the @p CH_CFG_USE_DELEGATES
  31:../../../os/oslib/src/chdelegates.c ****  *          option must be enabled in @p chconf.h.
  32:../../../os/oslib/src/chdelegates.c ****  * @note    Compatible with RT and NIL.
  33:../../../os/oslib/src/chdelegates.c ****  *
  34:../../../os/oslib/src/chdelegates.c ****  * @addtogroup oslib_delegates
  35:../../../os/oslib/src/chdelegates.c ****  * @{
  36:../../../os/oslib/src/chdelegates.c ****  */
  37:../../../os/oslib/src/chdelegates.c **** 
  38:../../../os/oslib/src/chdelegates.c **** #include "ch.h"
  39:../../../os/oslib/src/chdelegates.c **** 
  40:../../../os/oslib/src/chdelegates.c **** #if (CH_CFG_USE_DELEGATES == TRUE) || defined(__DOXYGEN__)
  41:../../../os/oslib/src/chdelegates.c **** 
  42:../../../os/oslib/src/chdelegates.c **** /*===========================================================================*/
  43:../../../os/oslib/src/chdelegates.c **** /* Module local definitions.                                                 */
  44:../../../os/oslib/src/chdelegates.c **** /*===========================================================================*/
  45:../../../os/oslib/src/chdelegates.c **** 
  46:../../../os/oslib/src/chdelegates.c **** /*===========================================================================*/
  47:../../../os/oslib/src/chdelegates.c **** /* Module exported variables.                                                */
  48:../../../os/oslib/src/chdelegates.c **** /*===========================================================================*/
  49:../../../os/oslib/src/chdelegates.c **** 
  50:../../../os/oslib/src/chdelegates.c **** /*===========================================================================*/
  51:../../../os/oslib/src/chdelegates.c **** /* Module local types.                                                       */
  52:../../../os/oslib/src/chdelegates.c **** /*===========================================================================*/
  53:../../../os/oslib/src/chdelegates.c **** 
  54:../../../os/oslib/src/chdelegates.c **** /**
  55:../../../os/oslib/src/chdelegates.c ****  * @brief   Type of a structure representing a delegate call.
  56:../../../os/oslib/src/chdelegates.c ****  */
  57:../../../os/oslib/src/chdelegates.c **** typedef struct {
  58:../../../os/oslib/src/chdelegates.c ****   /**
  59:../../../os/oslib/src/chdelegates.c ****    * @brief   The delegate veneer function.
  60:../../../os/oslib/src/chdelegates.c ****    */
  61:../../../os/oslib/src/chdelegates.c ****   delegate_veneer_t veneer;
  62:../../../os/oslib/src/chdelegates.c ****   /**
  63:../../../os/oslib/src/chdelegates.c ****    * @brief   Pointer to the caller @p va_list object.
  64:../../../os/oslib/src/chdelegates.c ****    */
  65:../../../os/oslib/src/chdelegates.c ****   va_list           *argsp;
  66:../../../os/oslib/src/chdelegates.c **** } call_message_t;
  67:../../../os/oslib/src/chdelegates.c **** 
  68:../../../os/oslib/src/chdelegates.c **** /*===========================================================================*/
  69:../../../os/oslib/src/chdelegates.c **** /* Module local variables.                                                   */
  70:../../../os/oslib/src/chdelegates.c **** /*===========================================================================*/
  71:../../../os/oslib/src/chdelegates.c **** 
  72:../../../os/oslib/src/chdelegates.c **** /*===========================================================================*/
  73:../../../os/oslib/src/chdelegates.c **** /* Module local functions.                                                   */
  74:../../../os/oslib/src/chdelegates.c **** /*===========================================================================*/
  75:../../../os/oslib/src/chdelegates.c **** 
  76:../../../os/oslib/src/chdelegates.c **** /*===========================================================================*/
  77:../../../os/oslib/src/chdelegates.c **** /* Module exported functions.                                                */
  78:../../../os/oslib/src/chdelegates.c **** /*===========================================================================*/
  79:../../../os/oslib/src/chdelegates.c **** 
  80:../../../os/oslib/src/chdelegates.c **** /*lint -save -e586 [17.1] Required by design.*/
  81:../../../os/oslib/src/chdelegates.c **** 
  82:../../../os/oslib/src/chdelegates.c **** /**
  83:../../../os/oslib/src/chdelegates.c ****  * @brief   Veneer for functions with no parameters.
  84:../../../os/oslib/src/chdelegates.c ****  *
  85:../../../os/oslib/src/chdelegates.c ****  * @param[in] argsp     the list of arguments
  86:../../../os/oslib/src/chdelegates.c ****  * @return              The function return value.
  87:../../../os/oslib/src/chdelegates.c ****  */
  88:../../../os/oslib/src/chdelegates.c **** msg_t __ch_delegate_fn0(va_list *argsp) {
  16               		.loc 1 88 0
  17               		.cfi_startproc
  18               	.LVL0:
  19               	/* prologue: function */
  20               	/* frame size = 0 */
  21               	/* stack size = 0 */
  22               	.L__stack_usage = 0
  89:../../../os/oslib/src/chdelegates.c ****   delegate_fn0_t fn0 = (delegate_fn0_t)va_arg(*argsp, delegate_fn0_t);
  23               		.loc 1 89 0
  24 0000 DC01      		movw r26,r24
  25 0002 ED91      		ld r30,X+
  26 0004 FC91      		ld r31,X
  27 0006 1197      		sbiw r26,1
  28 0008 9F01      		movw r18,r30
  29 000a 2E5F      		subi r18,-2
  30 000c 3F4F      		sbci r19,-1
  31 000e 2D93      		st X+,r18
  32 0010 3C93      		st X,r19
  33               	.LVL1:
  90:../../../os/oslib/src/chdelegates.c ****   return fn0();
  34               		.loc 1 90 0
  35 0012 0190      		ld __tmp_reg__,Z+
  36 0014 F081      		ld r31,Z
  37 0016 E02D      		mov r30,__tmp_reg__
  38               	.LVL2:
  39 0018 0994      		ijmp
  40               	.LVL3:
  41               		.cfi_endproc
  42               	.LFE98:
  44               		.section	.text.__ch_delegate_fn1,"ax",@progbits
  45               	.global	__ch_delegate_fn1
  47               	__ch_delegate_fn1:
  48               	.LFB99:
  91:../../../os/oslib/src/chdelegates.c **** }
  92:../../../os/oslib/src/chdelegates.c **** 
  93:../../../os/oslib/src/chdelegates.c **** /**
  94:../../../os/oslib/src/chdelegates.c ****  * @brief   Veneer for functions with one parameter.
  95:../../../os/oslib/src/chdelegates.c ****  *
  96:../../../os/oslib/src/chdelegates.c ****  * @param[in] argsp     the list of arguments
  97:../../../os/oslib/src/chdelegates.c ****  * @return              The function return value.
  98:../../../os/oslib/src/chdelegates.c ****  */
  99:../../../os/oslib/src/chdelegates.c **** msg_t __ch_delegate_fn1(va_list *argsp) {
  49               		.loc 1 99 0
  50               		.cfi_startproc
  51               	.LVL4:
  52 0000 CF93      		push r28
  53               	.LCFI0:
  54               		.cfi_def_cfa_offset 3
  55               		.cfi_offset 28, -2
  56 0002 DF93      		push r29
  57               	.LCFI1:
  58               		.cfi_def_cfa_offset 4
  59               		.cfi_offset 29, -3
  60               	/* prologue: function */
  61               	/* frame size = 0 */
  62               	/* stack size = 2 */
  63               	.L__stack_usage = 2
  64 0004 EC01      		movw r28,r24
 100:../../../os/oslib/src/chdelegates.c ****   delegate_fn1_t fn1 = (delegate_fn1_t)va_arg(*argsp, delegate_fn1_t);
  65               		.loc 1 100 0
  66 0006 A881      		ld r26,Y
  67 0008 B981      		ldd r27,Y+1
  68 000a CD01      		movw r24,r26
  69               	.LVL5:
  70 000c 0296      		adiw r24,2
  71 000e 9983      		std Y+1,r25
  72 0010 8883      		st Y,r24
  73 0012 ED91      		ld r30,X+
  74 0014 FC91      		ld r31,X
  75 0016 1197      		sbiw r26,1
  76               	.LVL6:
 101:../../../os/oslib/src/chdelegates.c ****   msg_t p1 = (msg_t)va_arg(*argsp, msg_t);
  77               		.loc 1 101 0
  78 0018 0296      		adiw r24,2
  79 001a 9983      		std Y+1,r25
  80 001c 8883      		st Y,r24
  81               	.LVL7:
 102:../../../os/oslib/src/chdelegates.c ****   return fn1(p1);
  82               		.loc 1 102 0
  83 001e 1296      		adiw r26,2
  84 0020 8D91      		ld r24,X+
  85 0022 9C91      		ld r25,X
  86 0024 1397      		sbiw r26,2+1
  87               	.LVL8:
  88               	/* epilogue start */
 103:../../../os/oslib/src/chdelegates.c **** }
  89               		.loc 1 103 0
  90 0026 DF91      		pop r29
  91 0028 CF91      		pop r28
  92               	.LVL9:
 102:../../../os/oslib/src/chdelegates.c ****   return fn1(p1);
  93               		.loc 1 102 0
  94 002a 0994      		ijmp
  95               	.LVL10:
  96               		.cfi_endproc
  97               	.LFE99:
  99               		.section	.text.__ch_delegate_fn2,"ax",@progbits
 100               	.global	__ch_delegate_fn2
 102               	__ch_delegate_fn2:
 103               	.LFB100:
 104:../../../os/oslib/src/chdelegates.c **** 
 105:../../../os/oslib/src/chdelegates.c **** /**
 106:../../../os/oslib/src/chdelegates.c ****  * @brief   Veneer for functions with two parameters.
 107:../../../os/oslib/src/chdelegates.c ****  *
 108:../../../os/oslib/src/chdelegates.c ****  * @param[in] argsp     the list of arguments
 109:../../../os/oslib/src/chdelegates.c ****  * @return              The function return value.
 110:../../../os/oslib/src/chdelegates.c ****  */
 111:../../../os/oslib/src/chdelegates.c **** msg_t __ch_delegate_fn2(va_list *argsp) {
 104               		.loc 1 111 0
 105               		.cfi_startproc
 106               	.LVL11:
 107 0000 CF93      		push r28
 108               	.LCFI2:
 109               		.cfi_def_cfa_offset 3
 110               		.cfi_offset 28, -2
 111 0002 DF93      		push r29
 112               	.LCFI3:
 113               		.cfi_def_cfa_offset 4
 114               		.cfi_offset 29, -3
 115               	/* prologue: function */
 116               	/* frame size = 0 */
 117               	/* stack size = 2 */
 118               	.L__stack_usage = 2
 119 0004 EC01      		movw r28,r24
 112:../../../os/oslib/src/chdelegates.c ****   delegate_fn2_t fn2 = (delegate_fn2_t)va_arg(*argsp, delegate_fn2_t);
 120               		.loc 1 112 0
 121 0006 A881      		ld r26,Y
 122 0008 B981      		ldd r27,Y+1
 123 000a CD01      		movw r24,r26
 124               	.LVL12:
 125 000c 0296      		adiw r24,2
 126 000e 9983      		std Y+1,r25
 127 0010 8883      		st Y,r24
 128 0012 ED91      		ld r30,X+
 129 0014 FC91      		ld r31,X
 130 0016 1197      		sbiw r26,1
 131               	.LVL13:
 113:../../../os/oslib/src/chdelegates.c ****   msg_t p1 = (msg_t)va_arg(*argsp, msg_t);
 132               		.loc 1 113 0
 133 0018 1296      		adiw r26,2
 134 001a 8D91      		ld r24,X+
 135 001c 9C91      		ld r25,X
 136 001e 1397      		sbiw r26,2+1
 137               	.LVL14:
 114:../../../os/oslib/src/chdelegates.c ****   msg_t p2 = (msg_t)va_arg(*argsp, msg_t);
 138               		.loc 1 114 0
 139 0020 9D01      		movw r18,r26
 140 0022 2A5F      		subi r18,-6
 141 0024 3F4F      		sbci r19,-1
 142 0026 3983      		std Y+1,r19
 143 0028 2883      		st Y,r18
 144               	.LVL15:
 115:../../../os/oslib/src/chdelegates.c ****   return fn2(p1, p2);
 145               		.loc 1 115 0
 146 002a 1496      		adiw r26,4
 147 002c 6D91      		ld r22,X+
 148 002e 7C91      		ld r23,X
 149 0030 1597      		sbiw r26,4+1
 150               	/* epilogue start */
 116:../../../os/oslib/src/chdelegates.c **** }
 151               		.loc 1 116 0
 152 0032 DF91      		pop r29
 153 0034 CF91      		pop r28
 154               	.LVL16:
 115:../../../os/oslib/src/chdelegates.c ****   return fn2(p1, p2);
 155               		.loc 1 115 0
 156 0036 0994      		ijmp
 157               	.LVL17:
 158               		.cfi_endproc
 159               	.LFE100:
 161               		.section	.text.__ch_delegate_fn3,"ax",@progbits
 162               	.global	__ch_delegate_fn3
 164               	__ch_delegate_fn3:
 165               	.LFB101:
 117:../../../os/oslib/src/chdelegates.c **** 
 118:../../../os/oslib/src/chdelegates.c **** /**
 119:../../../os/oslib/src/chdelegates.c ****  * @brief   Veneer for functions with three parameters.
 120:../../../os/oslib/src/chdelegates.c ****  *
 121:../../../os/oslib/src/chdelegates.c ****  * @param[in] argsp     the list of arguments
 122:../../../os/oslib/src/chdelegates.c ****  * @return              The function return value.
 123:../../../os/oslib/src/chdelegates.c ****  */
 124:../../../os/oslib/src/chdelegates.c **** msg_t __ch_delegate_fn3(va_list *argsp) {
 166               		.loc 1 124 0
 167               		.cfi_startproc
 168               	.LVL18:
 169 0000 CF93      		push r28
 170               	.LCFI4:
 171               		.cfi_def_cfa_offset 3
 172               		.cfi_offset 28, -2
 173 0002 DF93      		push r29
 174               	.LCFI5:
 175               		.cfi_def_cfa_offset 4
 176               		.cfi_offset 29, -3
 177               	/* prologue: function */
 178               	/* frame size = 0 */
 179               	/* stack size = 2 */
 180               	.L__stack_usage = 2
 181 0004 EC01      		movw r28,r24
 125:../../../os/oslib/src/chdelegates.c ****   delegate_fn3_t fn3 = (delegate_fn3_t)va_arg(*argsp, delegate_fn3_t);
 182               		.loc 1 125 0
 183 0006 A881      		ld r26,Y
 184 0008 B981      		ldd r27,Y+1
 185 000a CD01      		movw r24,r26
 186               	.LVL19:
 187 000c 0296      		adiw r24,2
 188 000e 9983      		std Y+1,r25
 189 0010 8883      		st Y,r24
 190 0012 ED91      		ld r30,X+
 191 0014 FC91      		ld r31,X
 192 0016 1197      		sbiw r26,1
 193               	.LVL20:
 126:../../../os/oslib/src/chdelegates.c ****   msg_t p1 = (msg_t)va_arg(*argsp, msg_t);
 194               		.loc 1 126 0
 195 0018 1296      		adiw r26,2
 196 001a 8D91      		ld r24,X+
 197 001c 9C91      		ld r25,X
 198 001e 1397      		sbiw r26,2+1
 199               	.LVL21:
 127:../../../os/oslib/src/chdelegates.c ****   msg_t p2 = (msg_t)va_arg(*argsp, msg_t);
 200               		.loc 1 127 0
 201 0020 1496      		adiw r26,4
 202 0022 6D91      		ld r22,X+
 203 0024 7C91      		ld r23,X
 204 0026 1597      		sbiw r26,4+1
 205               	.LVL22:
 128:../../../os/oslib/src/chdelegates.c ****   msg_t p3 = (msg_t)va_arg(*argsp, msg_t);
 206               		.loc 1 128 0
 207 0028 9D01      		movw r18,r26
 208 002a 285F      		subi r18,-8
 209 002c 3F4F      		sbci r19,-1
 210 002e 3983      		std Y+1,r19
 211 0030 2883      		st Y,r18
 212               	.LVL23:
 129:../../../os/oslib/src/chdelegates.c ****   return fn3(p1, p2, p3);
 213               		.loc 1 129 0
 214 0032 1696      		adiw r26,6
 215 0034 4D91      		ld r20,X+
 216 0036 5C91      		ld r21,X
 217 0038 1797      		sbiw r26,6+1
 218               	/* epilogue start */
 130:../../../os/oslib/src/chdelegates.c **** }
 219               		.loc 1 130 0
 220 003a DF91      		pop r29
 221 003c CF91      		pop r28
 222               	.LVL24:
 129:../../../os/oslib/src/chdelegates.c ****   return fn3(p1, p2, p3);
 223               		.loc 1 129 0
 224 003e 0994      		ijmp
 225               	.LVL25:
 226               		.cfi_endproc
 227               	.LFE101:
 229               		.section	.text.__ch_delegate_fn4,"ax",@progbits
 230               	.global	__ch_delegate_fn4
 232               	__ch_delegate_fn4:
 233               	.LFB102:
 131:../../../os/oslib/src/chdelegates.c **** 
 132:../../../os/oslib/src/chdelegates.c **** /**
 133:../../../os/oslib/src/chdelegates.c ****  * @brief   Veneer for functions with four parameters.
 134:../../../os/oslib/src/chdelegates.c ****  *
 135:../../../os/oslib/src/chdelegates.c ****  * @param[in] argsp     the list of arguments
 136:../../../os/oslib/src/chdelegates.c ****  * @return              The function return value.
 137:../../../os/oslib/src/chdelegates.c ****  */
 138:../../../os/oslib/src/chdelegates.c **** msg_t __ch_delegate_fn4(va_list *argsp) {
 234               		.loc 1 138 0
 235               		.cfi_startproc
 236               	.LVL26:
 237 0000 CF93      		push r28
 238               	.LCFI6:
 239               		.cfi_def_cfa_offset 3
 240               		.cfi_offset 28, -2
 241 0002 DF93      		push r29
 242               	.LCFI7:
 243               		.cfi_def_cfa_offset 4
 244               		.cfi_offset 29, -3
 245               	/* prologue: function */
 246               	/* frame size = 0 */
 247               	/* stack size = 2 */
 248               	.L__stack_usage = 2
 249 0004 EC01      		movw r28,r24
 139:../../../os/oslib/src/chdelegates.c ****   delegate_fn4_t fn4 = (delegate_fn4_t)va_arg(*argsp, delegate_fn4_t);
 250               		.loc 1 139 0
 251 0006 A881      		ld r26,Y
 252 0008 B981      		ldd r27,Y+1
 253 000a CD01      		movw r24,r26
 254               	.LVL27:
 255 000c 0296      		adiw r24,2
 256 000e 9983      		std Y+1,r25
 257 0010 8883      		st Y,r24
 258 0012 ED91      		ld r30,X+
 259 0014 FC91      		ld r31,X
 260 0016 1197      		sbiw r26,1
 261               	.LVL28:
 140:../../../os/oslib/src/chdelegates.c ****   msg_t p1 = (msg_t)va_arg(*argsp, msg_t);
 262               		.loc 1 140 0
 263 0018 1296      		adiw r26,2
 264 001a 8D91      		ld r24,X+
 265 001c 9C91      		ld r25,X
 266 001e 1397      		sbiw r26,2+1
 267               	.LVL29:
 141:../../../os/oslib/src/chdelegates.c ****   msg_t p2 = (msg_t)va_arg(*argsp, msg_t);
 268               		.loc 1 141 0
 269 0020 1496      		adiw r26,4
 270 0022 6D91      		ld r22,X+
 271 0024 7C91      		ld r23,X
 272 0026 1597      		sbiw r26,4+1
 273               	.LVL30:
 142:../../../os/oslib/src/chdelegates.c ****   msg_t p3 = (msg_t)va_arg(*argsp, msg_t);
 274               		.loc 1 142 0
 275 0028 1696      		adiw r26,6
 276 002a 4D91      		ld r20,X+
 277 002c 5C91      		ld r21,X
 278 002e 1797      		sbiw r26,6+1
 279               	.LVL31:
 143:../../../os/oslib/src/chdelegates.c ****   msg_t p4 = (msg_t)va_arg(*argsp, msg_t);
 280               		.loc 1 143 0
 281 0030 9D01      		movw r18,r26
 282 0032 265F      		subi r18,-10
 283 0034 3F4F      		sbci r19,-1
 284 0036 3983      		std Y+1,r19
 285 0038 2883      		st Y,r18
 286               	.LVL32:
 144:../../../os/oslib/src/chdelegates.c ****   return fn4(p1, p2, p3, p4);
 287               		.loc 1 144 0
 288 003a 1896      		adiw r26,8
 289 003c 2D91      		ld r18,X+
 290 003e 3C91      		ld r19,X
 291 0040 1997      		sbiw r26,8+1
 292               	/* epilogue start */
 145:../../../os/oslib/src/chdelegates.c **** }
 293               		.loc 1 145 0
 294 0042 DF91      		pop r29
 295 0044 CF91      		pop r28
 296               	.LVL33:
 144:../../../os/oslib/src/chdelegates.c ****   return fn4(p1, p2, p3, p4);
 297               		.loc 1 144 0
 298 0046 0994      		ijmp
 299               	.LVL34:
 300               		.cfi_endproc
 301               	.LFE102:
 303               		.section	.text.chDelegateCallVeneer,"ax",@progbits
 304               	.global	chDelegateCallVeneer
 306               	chDelegateCallVeneer:
 307               	.LFB103:
 146:../../../os/oslib/src/chdelegates.c **** 
 147:../../../os/oslib/src/chdelegates.c **** /**
 148:../../../os/oslib/src/chdelegates.c ****  * @brief   Triggers a function call on a delegate thread.
 149:../../../os/oslib/src/chdelegates.c ****  * @note    The thread must be executing @p chDelegateDispatchTimeout() in
 150:../../../os/oslib/src/chdelegates.c ****  *          order to have the functions called.
 151:../../../os/oslib/src/chdelegates.c ****  *
 152:../../../os/oslib/src/chdelegates.c ****  * @param[in] tp        pointer to the delegate thread
 153:../../../os/oslib/src/chdelegates.c ****  * @param[in] veneer    pointer to the veneer function to be called
 154:../../../os/oslib/src/chdelegates.c ****  * @param[in] ...       variable number of parameters
 155:../../../os/oslib/src/chdelegates.c ****  * @return              The function return value casted to msg_t. It is
 156:../../../os/oslib/src/chdelegates.c ****  *                      garbage for functions returning @p void.
 157:../../../os/oslib/src/chdelegates.c ****  */
 158:../../../os/oslib/src/chdelegates.c **** msg_t chDelegateCallVeneer(thread_t *tp, delegate_veneer_t veneer, ...) {
 308               		.loc 1 158 0
 309               		.cfi_startproc
 310               	.LVL35:
 311 0000 CF93      		push r28
 312               	.LCFI8:
 313               		.cfi_def_cfa_offset 3
 314               		.cfi_offset 28, -2
 315 0002 DF93      		push r29
 316               	.LCFI9:
 317               		.cfi_def_cfa_offset 4
 318               		.cfi_offset 29, -3
 319 0004 00D0      		rcall .
 320 0006 00D0      		rcall .
 321 0008 00D0      		rcall .
 322               	.LCFI10:
 323               		.cfi_def_cfa_offset 10
 324 000a CDB7      		in r28,__SP_L__
 325 000c DEB7      		in r29,__SP_H__
 326               	.LCFI11:
 327               		.cfi_def_cfa_register 28
 328               	/* prologue: function */
 329               	/* frame size = 6 */
 330               	/* stack size = 8 */
 331               	.L__stack_usage = 8
 159:../../../os/oslib/src/chdelegates.c ****   va_list args;
 160:../../../os/oslib/src/chdelegates.c ****   call_message_t cm;
 161:../../../os/oslib/src/chdelegates.c ****   msg_t msg;
 162:../../../os/oslib/src/chdelegates.c **** 
 163:../../../os/oslib/src/chdelegates.c ****   va_start(args, veneer);
 332               		.loc 1 163 0
 333 000e CE01      		movw r24,r28
 334 0010 0F96      		adiw r24,15
 335 0012 9E83      		std Y+6,r25
 336 0014 8D83      		std Y+5,r24
 164:../../../os/oslib/src/chdelegates.c **** 
 165:../../../os/oslib/src/chdelegates.c ****   /* Preparing the call message.*/
 166:../../../os/oslib/src/chdelegates.c ****   cm.veneer = veneer;
 337               		.loc 1 166 0
 338 0016 8D85      		ldd r24,Y+13
 339 0018 9E85      		ldd r25,Y+14
 340 001a 9A83      		std Y+2,r25
 341 001c 8983      		std Y+1,r24
 167:../../../os/oslib/src/chdelegates.c ****   cm.argsp  = &args;
 342               		.loc 1 167 0
 343 001e CE01      		movw r24,r28
 344 0020 0596      		adiw r24,5
 345 0022 9C83      		std Y+4,r25
 346 0024 8B83      		std Y+3,r24
 168:../../../os/oslib/src/chdelegates.c ****   (void)cm; /* Suppresses a lint warning.*/
 169:../../../os/oslib/src/chdelegates.c **** 
 170:../../../os/oslib/src/chdelegates.c ****   /* Sending the message to the dispatcher thread, the return value is
 171:../../../os/oslib/src/chdelegates.c ****      contained in the returned message.*/
 172:../../../os/oslib/src/chdelegates.c ****   msg = chMsgSend(tp, (msg_t)&cm);
 347               		.loc 1 172 0
 348 0026 BE01      		movw r22,r28
 349 0028 6F5F      		subi r22,-1
 350 002a 7F4F      		sbci r23,-1
 351 002c 8B85      		ldd r24,Y+11
 352 002e 9C85      		ldd r25,Y+12
 353 0030 0E94 0000 		call chMsgSend
 354               	.LVL36:
 355               	/* epilogue start */
 173:../../../os/oslib/src/chdelegates.c **** 
 174:../../../os/oslib/src/chdelegates.c ****   va_end(args);
 175:../../../os/oslib/src/chdelegates.c **** 
 176:../../../os/oslib/src/chdelegates.c ****   return msg;
 177:../../../os/oslib/src/chdelegates.c **** }
 356               		.loc 1 177 0
 357 0034 2696      		adiw r28,6
 358 0036 0FB6      		in __tmp_reg__,__SREG__
 359 0038 F894      		cli
 360 003a DEBF      		out __SP_H__,r29
 361 003c 0FBE      		out __SREG__,__tmp_reg__
 362 003e CDBF      		out __SP_L__,r28
 363 0040 DF91      		pop r29
 364 0042 CF91      		pop r28
 365 0044 0895      		ret
 366               		.cfi_endproc
 367               	.LFE103:
 369               		.section	.text.chDelegateDispatch,"ax",@progbits
 370               	.global	chDelegateDispatch
 372               	chDelegateDispatch:
 373               	.LFB104:
 178:../../../os/oslib/src/chdelegates.c **** 
 179:../../../os/oslib/src/chdelegates.c **** /*lint -restore*/
 180:../../../os/oslib/src/chdelegates.c **** 
 181:../../../os/oslib/src/chdelegates.c **** /**
 182:../../../os/oslib/src/chdelegates.c ****  * @brief   Call messages dispatching.
 183:../../../os/oslib/src/chdelegates.c ****  * @details The function awaits for an incoming call messages and calls the
 184:../../../os/oslib/src/chdelegates.c ****  *          specified functions, then it returns. In case multiple threads
 185:../../../os/oslib/src/chdelegates.c ****  *          are sending messages then the requests are served in priority
 186:../../../os/oslib/src/chdelegates.c ****  *          order.
 187:../../../os/oslib/src/chdelegates.c ****  *
 188:../../../os/oslib/src/chdelegates.c ****  * @api
 189:../../../os/oslib/src/chdelegates.c ****  */
 190:../../../os/oslib/src/chdelegates.c **** void chDelegateDispatch(void) {
 374               		.loc 1 190 0
 375               		.cfi_startproc
 376 0000 CF93      		push r28
 377               	.LCFI12:
 378               		.cfi_def_cfa_offset 3
 379               		.cfi_offset 28, -2
 380 0002 DF93      		push r29
 381               	.LCFI13:
 382               		.cfi_def_cfa_offset 4
 383               		.cfi_offset 29, -3
 384               	/* prologue: function */
 385               	/* frame size = 0 */
 386               	/* stack size = 2 */
 387               	.L__stack_usage = 2
 191:../../../os/oslib/src/chdelegates.c ****   thread_t *tp;
 192:../../../os/oslib/src/chdelegates.c ****   const call_message_t *cmp;
 193:../../../os/oslib/src/chdelegates.c ****   msg_t ret;
 194:../../../os/oslib/src/chdelegates.c **** 
 195:../../../os/oslib/src/chdelegates.c ****   tp = chMsgWait();
 388               		.loc 1 195 0
 389 0004 0E94 0000 		call chMsgWait
 390               	.LVL37:
 391 0008 EC01      		movw r28,r24
 392               	.LVL38:
 196:../../../os/oslib/src/chdelegates.c ****   cmp = (const call_message_t *)chMsgGet(tp);
 393               		.loc 1 196 0
 394 000a A885      		ldd r26,Y+8
 395 000c B985      		ldd r27,Y+9
 396               	.LVL39:
 197:../../../os/oslib/src/chdelegates.c ****   ret = cmp->veneer(cmp->argsp);
 397               		.loc 1 197 0
 398 000e ED91      		ld r30,X+
 399 0010 FC91      		ld r31,X
 400 0012 1197      		sbiw r26,1
 401 0014 1296      		adiw r26,2
 402 0016 8D91      		ld r24,X+
 403 0018 9C91      		ld r25,X
 404 001a 1397      		sbiw r26,2+1
 405               	.LVL40:
 406 001c 0995      		icall
 407               	.LVL41:
 198:../../../os/oslib/src/chdelegates.c **** 
 199:../../../os/oslib/src/chdelegates.c ****   chMsgRelease(tp, ret);
 408               		.loc 1 199 0
 409 001e BC01      		movw r22,r24
 410 0020 CE01      		movw r24,r28
 411               	.LVL42:
 412               	/* epilogue start */
 200:../../../os/oslib/src/chdelegates.c **** }
 413               		.loc 1 200 0
 414 0022 DF91      		pop r29
 415 0024 CF91      		pop r28
 416               	.LVL43:
 199:../../../os/oslib/src/chdelegates.c **** }
 417               		.loc 1 199 0
 418 0026 0C94 0000 		jmp chMsgRelease
 419               	.LVL44:
 420               		.cfi_endproc
 421               	.LFE104:
 423               		.section	.text.chDelegateDispatchTimeout,"ax",@progbits
 424               	.global	chDelegateDispatchTimeout
 426               	chDelegateDispatchTimeout:
 427               	.LFB105:
 201:../../../os/oslib/src/chdelegates.c **** 
 202:../../../os/oslib/src/chdelegates.c **** /**
 203:../../../os/oslib/src/chdelegates.c ****  * @brief   Call messages dispatching with timeout.
 204:../../../os/oslib/src/chdelegates.c ****  * @details The function awaits for an incoming call messages and calls the
 205:../../../os/oslib/src/chdelegates.c ****  *          specified functions, then it returns. In case multiple threads
 206:../../../os/oslib/src/chdelegates.c ****  *          are sending messages then the requests are served in priority
 207:../../../os/oslib/src/chdelegates.c ****  *          order.
 208:../../../os/oslib/src/chdelegates.c ****  *
 209:../../../os/oslib/src/chdelegates.c ****  * @param[in] timeout   the number of ticks before the operation timeouts,
 210:../../../os/oslib/src/chdelegates.c ****  *                      the following special values are allowed:
 211:../../../os/oslib/src/chdelegates.c ****  *                      - @a TIME_INFINITE no timeout.
 212:../../../os/oslib/src/chdelegates.c ****  *                      .
 213:../../../os/oslib/src/chdelegates.c ****  * @return              The function outcome.
 214:../../../os/oslib/src/chdelegates.c ****  * @retval MSG_OK       if a function has been called.
 215:../../../os/oslib/src/chdelegates.c ****  * @retval MSG_TIMEOUT  if a timeout occurred.
 216:../../../os/oslib/src/chdelegates.c ****  *
 217:../../../os/oslib/src/chdelegates.c ****  * @api
 218:../../../os/oslib/src/chdelegates.c ****  */
 219:../../../os/oslib/src/chdelegates.c **** msg_t chDelegateDispatchTimeout(sysinterval_t timeout) {
 428               		.loc 1 219 0
 429               		.cfi_startproc
 430               	.LVL45:
 431 0000 CF93      		push r28
 432               	.LCFI14:
 433               		.cfi_def_cfa_offset 3
 434               		.cfi_offset 28, -2
 435 0002 DF93      		push r29
 436               	.LCFI15:
 437               		.cfi_def_cfa_offset 4
 438               		.cfi_offset 29, -3
 439               	/* prologue: function */
 440               	/* frame size = 0 */
 441               	/* stack size = 2 */
 442               	.L__stack_usage = 2
 220:../../../os/oslib/src/chdelegates.c ****   thread_t *tp;
 221:../../../os/oslib/src/chdelegates.c ****   const call_message_t *cmp;
 222:../../../os/oslib/src/chdelegates.c ****   msg_t ret;
 223:../../../os/oslib/src/chdelegates.c **** 
 224:../../../os/oslib/src/chdelegates.c ****   tp = chMsgWaitTimeout(timeout);
 443               		.loc 1 224 0
 444 0004 0E94 0000 		call chMsgWaitTimeout
 445               	.LVL46:
 446 0008 EC01      		movw r28,r24
 447               	.LVL47:
 225:../../../os/oslib/src/chdelegates.c ****   if (tp == NULL) {
 448               		.loc 1 225 0
 449 000a 892B      		or r24,r25
 450 000c 01F0      		breq .L10
 226:../../../os/oslib/src/chdelegates.c ****     return MSG_TIMEOUT;
 227:../../../os/oslib/src/chdelegates.c ****   }
 228:../../../os/oslib/src/chdelegates.c **** 
 229:../../../os/oslib/src/chdelegates.c ****   cmp = (const call_message_t *)chMsgGet(tp);
 451               		.loc 1 229 0
 452 000e A885      		ldd r26,Y+8
 453 0010 B985      		ldd r27,Y+9
 454               	.LVL48:
 230:../../../os/oslib/src/chdelegates.c ****   ret = cmp->veneer(cmp->argsp);
 455               		.loc 1 230 0
 456 0012 ED91      		ld r30,X+
 457 0014 FC91      		ld r31,X
 458 0016 1197      		sbiw r26,1
 459 0018 1296      		adiw r26,2
 460 001a 8D91      		ld r24,X+
 461 001c 9C91      		ld r25,X
 462 001e 1397      		sbiw r26,2+1
 463               	.LVL49:
 464 0020 0995      		icall
 465               	.LVL50:
 231:../../../os/oslib/src/chdelegates.c **** 
 232:../../../os/oslib/src/chdelegates.c ****   chMsgRelease(tp, ret);
 466               		.loc 1 232 0
 467 0022 BC01      		movw r22,r24
 468 0024 CE01      		movw r24,r28
 469               	.LVL51:
 470 0026 0E94 0000 		call chMsgRelease
 471               	.LVL52:
 233:../../../os/oslib/src/chdelegates.c **** 
 234:../../../os/oslib/src/chdelegates.c ****   return MSG_OK;
 472               		.loc 1 234 0
 473 002a 80E0      		ldi r24,0
 474 002c 90E0      		ldi r25,0
 475               	.L9:
 476               	/* epilogue start */
 235:../../../os/oslib/src/chdelegates.c **** }
 477               		.loc 1 235 0
 478 002e DF91      		pop r29
 479 0030 CF91      		pop r28
 480               	.LVL53:
 481 0032 0895      		ret
 482               	.LVL54:
 483               	.L10:
 226:../../../os/oslib/src/chdelegates.c ****   }
 484               		.loc 1 226 0
 485 0034 8FEF      		ldi r24,lo8(-1)
 486 0036 9FEF      		ldi r25,lo8(-1)
 487               	.LVL55:
 488 0038 00C0      		rjmp .L9
 489               		.cfi_endproc
 490               	.LFE105:
 492               		.text
 493               	.Letext0:
 494               		.file 2 "/usr/lib/avr/include/stdint.h"
 495               		.file 3 "../../../os/common/ports/AVR/compilers/GCC/chtypes.h"
 496               		.file 4 "../../../os/nil/include/ch.h"
 497               		.file 5 "../../../os/common/ports/AVR/chcore.h"
 498               		.file 6 "/usr/lib/gcc/avr/5.4.0/include/stdarg.h"
 499               		.file 7 "../../../os/oslib/include/chdelegates.h"
 500               		.file 8 "../../../os/nil/include/chmsg.h"
DEFINED SYMBOLS
                            *ABS*:0000000000000000 chdelegates.c
     /tmp/ccXaJ6yE.s:2      *ABS*:000000000000003e __SP_H__
     /tmp/ccXaJ6yE.s:3      *ABS*:000000000000003d __SP_L__
     /tmp/ccXaJ6yE.s:4      *ABS*:000000000000003f __SREG__
     /tmp/ccXaJ6yE.s:5      *ABS*:0000000000000000 __tmp_reg__
     /tmp/ccXaJ6yE.s:6      *ABS*:0000000000000001 __zero_reg__
     /tmp/ccXaJ6yE.s:13     .text.__ch_delegate_fn0:0000000000000000 __ch_delegate_fn0
     /tmp/ccXaJ6yE.s:47     .text.__ch_delegate_fn1:0000000000000000 __ch_delegate_fn1
     /tmp/ccXaJ6yE.s:102    .text.__ch_delegate_fn2:0000000000000000 __ch_delegate_fn2
     /tmp/ccXaJ6yE.s:164    .text.__ch_delegate_fn3:0000000000000000 __ch_delegate_fn3
     /tmp/ccXaJ6yE.s:232    .text.__ch_delegate_fn4:0000000000000000 __ch_delegate_fn4
     /tmp/ccXaJ6yE.s:306    .text.chDelegateCallVeneer:0000000000000000 chDelegateCallVeneer
     /tmp/ccXaJ6yE.s:372    .text.chDelegateDispatch:0000000000000000 chDelegateDispatch
     /tmp/ccXaJ6yE.s:426    .text.chDelegateDispatchTimeout:0000000000000000 chDelegateDispatchTimeout

UNDEFINED SYMBOLS
chMsgSend
chMsgWait
chMsgRelease
chMsgWaitTimeout
